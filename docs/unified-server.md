# ç»Ÿä¸€æ¼”ç¤ºæœåŠ¡å™¨ä½¿ç”¨è¯´æ˜

## ğŸ¯ æ¦‚è¿°

ç»Ÿä¸€æ¼”ç¤ºæœåŠ¡å™¨å°†åŸæ¥çš„ä¸¤ä¸ªæœåŠ¡å™¨ï¼ˆAPIæµ‹è¯•æœåŠ¡å™¨å’Œæ¼”ç¤ºé¡µé¢æœåŠ¡å™¨ï¼‰åˆå¹¶ä¸ºä¸€ä¸ªï¼Œç®€åŒ–äº†å¼€å‘å’Œæµ‹è¯•æµç¨‹ã€‚

## ğŸš€ å¯åŠ¨æœåŠ¡å™¨

```bash
# æ–¹å¼1: ä½¿ç”¨yarnï¼ˆæ¨èï¼‰
yarn demo

# æ–¹å¼2: ä½¿ç”¨npm
npm run demo

# æ–¹å¼3: ç›´æ¥è¿è¡Œ
node packages/demo/src/unified-server.mjs
```

## ğŸ“ è®¿é—®åœ°å€

æœåŠ¡å™¨å¯åŠ¨åï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹åœ°å€è®¿é—®ï¼š

- **æ¼”ç¤ºé¡µé¢**: http://localhost:3000
- **APIæœåŠ¡**: http://localhost:3000/api
- **é™æ€èµ„æº**: 
  - http://localhost:3000/dist (æ„å»ºè¾“å‡º)
  - http://localhost:3000/packages (æºç åŒ…)

## ğŸ”§ åŠŸèƒ½ç‰¹æ€§

### 1. ç»Ÿä¸€ç«¯å£
- æ‰€æœ‰æœåŠ¡éƒ½åœ¨ç«¯å£3000ä¸Šè¿è¡Œ
- æ— éœ€ç®¡ç†å¤šä¸ªç«¯å£
- ç®€åŒ–äº†CORSé…ç½®

### 2. å®Œæ•´APIæ”¯æŒ
åŒ…å«æ‰€æœ‰åŸtest-serverçš„APIç«¯ç‚¹ï¼š

#### è®¤è¯ç›¸å…³
- `POST /api/v1/access_token` - è·å–è®¿é—®ä»¤ç‰Œ

#### ç”¨æˆ·ç®¡ç†
- `GET /api/v1/user/info` - è·å–ç”¨æˆ·ä¿¡æ¯
- `GET /api/v1/user/storage` - è·å–å­˜å‚¨ç©ºé—´ä¿¡æ¯

#### æ–‡ä»¶ç®¡ç†
- `GET /api/v1/file/list` - è·å–æ–‡ä»¶åˆ—è¡¨
- `GET /api/v1/file/info/:fileId` - è·å–æ–‡ä»¶è¯¦æƒ…
- `POST /api/v1/file/mkdir` - åˆ›å»ºæ–‡ä»¶å¤¹
- `DELETE /api/v1/file/:fileId` - åˆ é™¤æ–‡ä»¶

#### åˆ†äº«ç®¡ç†
- `POST /api/v1/share/create` - åˆ›å»ºåˆ†äº«
- `GET /api/v1/share/list` - è·å–åˆ†äº«åˆ—è¡¨
- `GET /api/v1/share/:shareId` - è·å–åˆ†äº«è¯¦æƒ…
- `DELETE /api/v1/share/:shareId` - åˆ é™¤åˆ†äº«

#### ç¦»çº¿ä¸‹è½½
- `POST /api/v1/offline/create` - åˆ›å»ºä¸‹è½½ä»»åŠ¡
- `GET /api/v1/offline/list` - è·å–ä»»åŠ¡åˆ—è¡¨
- `POST /api/v1/offline/pause/:taskId` - æš‚åœä»»åŠ¡
- `DELETE /api/v1/offline/:taskId` - åˆ é™¤ä»»åŠ¡

#### ç›´é“¾ç®¡ç†
- `POST /api/v1/direct-link/create` - åˆ›å»ºç›´é“¾
- `GET /api/v1/direct-link/list` - è·å–ç›´é“¾åˆ—è¡¨

#### å›¾åºŠç®¡ç†
- `GET /api/v1/image/list` - è·å–å›¾ç‰‡åˆ—è¡¨

#### è§†é¢‘è½¬ç 
- `POST /api/v1/video/transcode` - åˆ›å»ºè½¬ç ä»»åŠ¡
- `GET /api/v1/video/tasks` - è·å–è½¬ç ä»»åŠ¡åˆ—è¡¨

### 3. æ¼”ç¤ºé¡µé¢åŠŸèƒ½
- å®Œæ•´çš„SDKæµ‹è¯•ç•Œé¢
- å®æ—¶æ—¥å¿—æ˜¾ç¤º
- æ€§èƒ½ç›‘æ§
- é…ç½®ç®¡ç†
- å¼€å‘å·¥å…·é¢æ¿

### 4. å¼€å‘å‹å¥½
- æ”¯æŒSource Mapsè°ƒè¯•
- è‡ªåŠ¨é‡è½½åŠŸèƒ½
- è¯¦ç»†çš„è¯·æ±‚/å“åº”æ—¥å¿—
- é”™è¯¯å¤„ç†å’Œç»Ÿè®¡

## ğŸ› ï¸ å¼€å‘å·¥ä½œæµ

### 1. å¯åŠ¨å¼€å‘ç¯å¢ƒ
```bash
# å¯åŠ¨æœåŠ¡å™¨
yarn demo

# åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€
open http://localhost:3000
```

### 2. ä¿®æ”¹SDKæºç 
```bash
# ä¿®æ”¹æºç åé‡æ–°æ„å»º
yarn build

# å¦‚æœå¼€å¯äº†è‡ªåŠ¨é‡è½½ï¼Œæ¼”ç¤ºé¡µé¢ä¼šè‡ªåŠ¨æ›´æ–°
```

### 3. æµ‹è¯•API
```bash
# å¯ä»¥ç›´æ¥ä½¿ç”¨curlæµ‹è¯•API
curl -X POST http://localhost:3000/api/v1/access_token \
  -H "Content-Type: application/json" \
  -d '{"clientID":"test-client-id","clientSecret":"test-client-secret"}'
```

## ğŸ“Š ä¼˜åŠ¿å¯¹æ¯”

### ä¹‹å‰ï¼ˆä¸¤ä¸ªæœåŠ¡å™¨ï¼‰
- éœ€è¦å¯åŠ¨ä¸¤ä¸ªæœåŠ¡å™¨ï¼ˆç«¯å£3000å’Œ8080ï¼‰
- éœ€è¦é…ç½®CORS
- ç®¡ç†å¤æ‚
- ç«¯å£å†²çªé£é™©

### ç°åœ¨ï¼ˆç»Ÿä¸€æœåŠ¡å™¨ï¼‰
- åªéœ€å¯åŠ¨ä¸€ä¸ªæœåŠ¡å™¨ï¼ˆç«¯å£3000ï¼‰
- è‡ªåŠ¨å¤„ç†CORS
- ç®¡ç†ç®€å•
- å‡å°‘èµ„æºå ç”¨

## ğŸ” æ•…éšœæ’é™¤

### ç«¯å£å ç”¨
å¦‚æœç«¯å£3000è¢«å ç”¨ï¼š
```bash
# æŸ¥æ‰¾å ç”¨è¿›ç¨‹
lsof -i :3000

# ç»ˆæ­¢è¿›ç¨‹
kill -9 <PID>
```

### æœåŠ¡å™¨æ— æ³•å¯åŠ¨
æ£€æŸ¥ä»¥ä¸‹å‡ ç‚¹ï¼š
1. Node.jsç‰ˆæœ¬æ˜¯å¦ >= 16
2. ä¾èµ–æ˜¯å¦å·²å®‰è£… (`yarn install`)
3. ç«¯å£3000æ˜¯å¦å¯ç”¨
4. æ–‡ä»¶æƒé™æ˜¯å¦æ­£ç¡®

### APIè°ƒç”¨å¤±è´¥
1. ç¡®è®¤æœåŠ¡å™¨æ­£åœ¨è¿è¡Œ
2. æ£€æŸ¥APIç«¯ç‚¹æ˜¯å¦æ­£ç¡®
3. éªŒè¯è¯·æ±‚æ ¼å¼å’Œå‚æ•°
4. æŸ¥çœ‹æœåŠ¡å™¨æ§åˆ¶å°æ—¥å¿—

## ğŸ“ é…ç½®è¯´æ˜

### æµ‹è¯•å‡­è¯
- **Client ID**: `test-client-id`
- **Client Secret**: `test-client-secret`

### é»˜è®¤é…ç½®
- **ç«¯å£**: 3000
- **APIå‰ç¼€**: `/api/v1`
- **ä»¤ç‰Œæœ‰æ•ˆæœŸ**: 1å°æ—¶
- **CORS**: å…è®¸æ‰€æœ‰æ¥æº

### è‡ªå®šä¹‰é…ç½®
å¯ä»¥é€šè¿‡ä¿®æ”¹ `packages/demo/src/unified-server.mjs` æ¥è‡ªå®šä¹‰ï¼š
- ç«¯å£å·
- APIè·¯å¾„
- æ¨¡æ‹Ÿæ•°æ®
- ä¸­é—´ä»¶é…ç½®

## ğŸš€ éƒ¨ç½²å»ºè®®

### å¼€å‘ç¯å¢ƒ
ç›´æ¥ä½¿ç”¨ `yarn demo` å¯åŠ¨å³å¯

### ç”Ÿäº§ç¯å¢ƒ
```bash
# ä½¿ç”¨PM2ç®¡ç†è¿›ç¨‹
npm install -g pm2
pm2 start packages/demo/src/unified-server.mjs --name "123pan-demo"

# æˆ–ä½¿ç”¨Docker
# åˆ›å»ºDockerfileå¹¶æ„å»ºé•œåƒ
```

è¿™ä¸ªç»Ÿä¸€æœåŠ¡å™¨å¤§å¤§ç®€åŒ–äº†å¼€å‘å’Œæµ‹è¯•æµç¨‹ï¼Œæä¾›äº†æ›´å¥½çš„å¼€å‘ä½“éªŒï¼
